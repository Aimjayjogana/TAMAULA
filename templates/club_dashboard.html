{% extends "base.html" %}

{% block title %}Club Dashboard - TAMAULA{% endblock %}

{% block content %}
<div class="dashboard-content">
    <div class="dashboard-header">
        <div style="display: flex; align-items: center; gap: 1rem;">
            <img src="{% if club.logo %}{{ url_for('static', filename='images/uploads/' + club.logo) }}{% else %}{{ url_for('static', filename='images/default-club.png') }}{% endif %}" 
                 alt="{{ club.name }}" style="width: 80px; height: 80px; border-radius: 50%; object-fit: cover;">
            <div>
                <h1>{{ club.name }}</h1>
                <p>Club Dashboard - {{ club.local_government }}</p>
            </div>
        </div>
    </div>

    <div class="stats-grid">
        <div class="stat-card">
            <div class="value">{{ players|length }}</div>
            <div class="label">Total Players</div>
        </div>
        <div class="stat-card">
            <div class="value">{{ competitions|length }}</div>
            <div class="label">Competitions</div>
        </div>
        <div class="stat-card">
            <div class="value">0</div>
            <div class="label">Matches Played</div>
        </div>
        <div class="stat-card">
            <div class="value">0</div>
            <div class="label">Total Goals</div>
        </div>
    </div>

    <div class="card-grid">
        <div class="card">
            <h3>Club Information</h3>
            <p><strong>Name:</strong> {{ club.name }}</p>
            <p><strong>Local Government:</strong> {{ club.local_government }}</p>
            <p><strong>Email:</strong> {{ club.email }}</p>
            <p><strong>Phone:</strong> {{ club.phone if club.phone else 'N/A' }}</p>
            <p><strong>Registration Date:</strong> {{ club.registration_date }}</p>
            <a href="{{ url_for('edit_club_details') }}" class="btn" style="margin-top: 1rem;">Edit Club Details</a>
        </div>

        <div class="card">
            <h3 >Team Management</h3> 
             <a href="{{ url_for('club_matches') }}" class="btn" style="margin-bottom: 1rem;">View Matches</a>
            <a href="{{ url_for('competition_registration') }}" class="btn" style="margin-bottom: 1rem;">Register for Competition</a>
            <a href="{{ url_for('manage_lineup') }}" class="btn" style="margin-bottom: 1rem;">Manage Lineup</a>
            <a href="{{ url_for('register_player') }}" class="btn">Add New Player</a>
            <a href="{{ url_for('club_player_approvals') }}" class="btn" style="margin-bottom: 1rem;">
        Player Approvals 
        {% if pending_count > 0 %}
        <span style="background: var(--warning); color: white; border-radius: 50%; width: 20px; height: 20px; display: inline-flex; align-items: center; justify-content: center; font-size: 0.8rem; margin-left: 0.5rem;">
            {{ pending_count }}
        </span>
        {% endif %}
    </a>
        </div>
    </div>
    <div class="card">
    <h3>Transfer Management</h3>
    <p>Manage player transfer requests</p>
    <a href="{{ url_for('club_transfer_requests') }}" class="btn">
        View Transfer Requests
    </a>
</div>

    <div class="card" style="margin-top: 2rem;">
        <h3>Player Roster</h3>
        <div class="table-container">
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Player</th>
                        <th>Jersey #</th>
                        <th>Position</th>
                        <th>Goals</th>
                        <th>Assists</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for player in players %}
                    <tr>
                        <td>
                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                <img src="{% if player.profile_picture %}{{ url_for('static', filename='images/uploads/' + player.profile_picture) }}{% else %}{{ url_for('static', filename='images/default-player.jpg') }}{% endif %}" 
                                     alt="{{ player.fullname }}" style="width: 40px; height: 40px; border-radius: 50%; object-fit: cover;">
                                {{ player.fullname }}
                            </div>
                        </td>
                        <td>#{{ player.jersey_number if player.jersey_number else 'N/A' }}</td>
                        <td>Not Set</td>
                        <td>{{ player.goals }}</td>
                        <td>{{ player.assists }}</td>
                        <td>
                            <button class="btn" style="padding: 0.25rem 0.5rem; font-size: 0.8rem;">Edit</button>
                            <button class="btn" style="padding: 0.25rem 0.5rem; font-size: 0.8rem; background: var(--error);">Remove</button>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <div class="card" style="margin-top: 2rem;">
        <h3>Competition Registrations</h3>
        <div class="table-container">
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Competition</th>
                        <th>Registration Date</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for competition in competitions %}
                    <tr>
                        <td>{{ competition.name }}</td>
                        <td>{{ competition.registration_date }}</td>
                        <td>
                            <span style="padding: 0.25rem 0.5rem; border-radius: 15px; font-size: 0.8rem; 
                            background: {% if competition.status == 'approved' %}var(--success)
                                      {% elif competition.status == 'pending' %}var(--warning)
                                      {% else %}var(--error){% endif %}; color: white;">
                                {{ competition.status|title }}
                            </span>
                        </td>
                        <td>
                            {% if competition.status == 'approved' %}
                            <a href="{{ url_for('competition_details', competition_id=competition.id) }}" class="btn" style="padding: 0.25rem 0.5rem; font-size: 0.8rem;">View Details</a>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}